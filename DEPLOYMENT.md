# V6 Data Extraction System - éƒ¨ç½²å’Œæ¸¬è©¦æŒ‡å—

## ğŸ“‹ ç³»çµ±æ¦‚è¿°

V6ç³»çµ±åŒ…å«å…©å€‹æ ¸å¿ƒæœå‹™ï¼š
- **hisbet**: æ­·å²æ•¸æ“šçˆ¬èŸ²ï¼ˆv6-unified-crawler.jsï¼‰
- **realbet**: å³æ™‚æ•¸æ“šç›£è½å™¨ï¼ˆrealtime-listener.jsï¼‰

## ğŸš€ å¿«é€Ÿå•Ÿå‹•

### 1. å®‰è£ä¾è³´

```bash
# é€²å…¥é …ç›®ç›®éŒ„
cd /Users/kw/Desktop/pkskw/v4bets/b6v

# å®‰è£æ­·å²æ•¸æ“šçˆ¬èŸ²ä¾è³´
npm install ethers@^6.15.0 pg@^8.11.3

# å¦‚æœè¦é‹è¡Œå³æ™‚ç›£è½å™¨ï¼Œé¡å¤–å®‰è£
npm install ws@^8.20.0
```

### 2. ç’°å¢ƒè®Šæ•¸è¨­ç½®

```bash
# å¯é¸ï¼šè¨­ç½®è‡ªå®šç¾©æ•¸æ“šåº«URL
export V6_DATABASE_URL="your_postgresql_connection_string"

# å¯é¸ï¼šè¨­ç½®è‡ªå®šç¾©RPCç¯€é»
export V6_RPC_URL="your_rpc_url"
```

### 3. å•Ÿå‹•æœå‹™

#### æ­·å²æ•¸æ“šçˆ¬èŸ² (hisbet)
```bash
# ä½¿ç”¨å•Ÿå‹•è…³æœ¬ï¼ˆæ¨è–¦ï¼‰
./start-hisbet.sh

# æˆ–è€…ç›´æ¥å•Ÿå‹•
node v6-unified-crawler.js --daemon

# æ‰‹å‹•è™•ç†æŒ‡å®šç¯„åœ
node v6-unified-crawler.js 395000 395100
```

#### å³æ™‚æ•¸æ“šç›£è½å™¨ (realbet)
```bash
# ä½¿ç”¨å•Ÿå‹•è…³æœ¬ï¼ˆæ¨è–¦ï¼‰
./start-realbet.sh

# æˆ–è€…ç›´æ¥å•Ÿå‹•
node realtime-listener.js
```

## ğŸ§ª æ¸¬è©¦åŠŸèƒ½

### åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
```bash
# æ¸¬è©¦ç³»çµ±åŸºæœ¬åŠŸèƒ½
node test-crawler.js

# æ¸¬è©¦ç¯„åœè™•ç†åŠŸèƒ½
node test-crawler.js --range
```

### åŠŸèƒ½é©—è­‰æª¢æŸ¥é …ç›®

#### hisbetï¼ˆæ­·å²æ•¸æ“šçˆ¬èŸ²ï¼‰
- [ ] æ•¸æ“šåº«é€£æ¥æˆåŠŸ
- [ ] ç²å–ç•¶å‰å±€æ¬¡
- [ ] è™•ç†å–®å€‹å±€æ¬¡æ•¸æ“š
- [ ] é›™ç·šç¨‹ç³»çµ±é‹è¡Œï¼ˆä¸»ç·š+æ”¯ç·šï¼‰
- [ ] æ•¸æ“šå®Œæ•´æ€§é©—è­‰
- [ ] è‡ªå‹•æ¸…ç†å’Œå„ªé›…é‡å•Ÿ

#### realbetï¼ˆå³æ™‚æ•¸æ“šç›£è½å™¨ï¼‰
- [ ] WebSocketé€£æ¥å€å¡Šéˆ
- [ ] ç›£è½ä¸‹æ³¨äº‹ä»¶ï¼ˆBetBull/BetBearï¼‰
- [ ] å¯ç–‘éŒ¢åŒ…æª¢æ¸¬
- [ ] WebSocketæœå‹™å™¨å•Ÿå‹•ï¼ˆç«¯å£3010ï¼‰
- [ ] æ•¸æ“šæ¨é€çµ¦å‰ç«¯
- [ ] é‡è¤‡ä¸‹æ³¨æª¢æ¸¬

## ğŸ“Š ç›£æ§å’Œæ—¥èªŒ

### ç³»çµ±ç‹€æ…‹æª¢æŸ¥
```bash
# æª¢æŸ¥hisbeté‹è¡Œç‹€æ…‹
curl -s http://localhost:3008/api/health 2>/dev/null || echo "hisbet not running"

# æª¢æŸ¥realbet WebSocketæœå‹™å™¨
curl -s http://localhost:3010 2>/dev/null || echo "realbet not running"

# æª¢æŸ¥æ•¸æ“šåº«é€£æ¥
psql $V6_DATABASE_URL -c "SELECT NOW();"
```

### æ—¥èªŒç›£æ§
- ğŸš€ å•Ÿå‹•ä¿¡æ¯ï¼šæœå‹™åˆå§‹åŒ–æˆåŠŸ
- âœ… æ•¸æ“šè™•ç†ï¼šå±€æ¬¡è™•ç†æˆåŠŸ/å¤±æ•—
- ğŸ“Š çµ±è¨ˆä¿¡æ¯ï¼šè™•ç†çš„å±€æ¬¡/ä¸‹æ³¨/é ˜çæ•¸é‡
- ğŸš¨ è­¦å‘Šä¿¡æ¯ï¼šå¯ç–‘éŒ¢åŒ…æª¢æ¸¬
- âŒ éŒ¯èª¤ä¿¡æ¯ï¼šé€£æ¥å¤±æ•—ã€æ•¸æ“šéŒ¯èª¤

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **æ•¸æ“šåº«é€£æ¥å¤±æ•—**
   ```bash
   # æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
   echo $V6_DATABASE_URL
   
   # æ¸¬è©¦é€£æ¥
   psql $V6_DATABASE_URL -c "SELECT 1;"
   ```

2. **å€å¡Šéˆé€£æ¥å¤±æ•—**
   ```bash
   # æª¢æŸ¥RPCç¯€é»
   curl -X POST $V6_RPC_URL \
     -H "Content-Type: application/json" \
     -d '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'
   ```

3. **ç«¯å£è¡çª**
   ```bash
   # æª¢æŸ¥ç«¯å£ä½¿ç”¨æƒ…æ³
   lsof -i :3008  # hisbetå‰ç«¯æœå‹™å™¨
   lsof -i :3010  # realbet WebSocketæœå‹™å™¨
   ```

### é‡å•Ÿæœå‹™
```bash
# å„ªé›…åœæ­¢ï¼ˆCtrl+Cï¼‰ç„¶å¾Œé‡æ–°å•Ÿå‹•
./start-hisbet.sh
./start-realbet.sh
```

## ğŸ“ˆ æ€§èƒ½å„ªåŒ–

### æ­·å²æ•¸æ“šçˆ¬èŸ²
- æ¯30åˆ†é˜è‡ªå‹•é‡å•Ÿä¸»ç·šä»»å‹™
- æ¯5åˆ†é˜æª¢æŸ¥æœ€æ–°æ•¸æ“š
- é€Ÿç‡é™åˆ¶ï¼š100è«‹æ±‚/ç§’
- è‡ªå‹•éŒ¯èª¤é‡è©¦æ©Ÿåˆ¶

### å³æ™‚æ•¸æ“šç›£è½å™¨
- WebSocketè‡ªå‹•é‡é€£
- å…§å­˜ä¸­é‡è¤‡æª¢æ¸¬
- å¯ç–‘éŒ¢åŒ…å¯¦æ™‚æ¨™è¨˜
- èˆŠæ•¸æ“šè‡ªå‹•æ¸…ç†

## ğŸš§ éƒ¨ç½²æ³¨æ„äº‹é …

1. **Node.jsç‰ˆæœ¬**: éœ€è¦18.0.0æˆ–æ›´é«˜
2. **å…§å­˜è¦æ±‚**: å»ºè­°è‡³å°‘512MB
3. **ç¶²çµ¡è¦æ±‚**: ç©©å®šçš„å€å¡ŠéˆRPCé€£æ¥
4. **æ•¸æ“šåº«**: PostgreSQL 12+
5. **æ™‚å€è¨­ç½®**: ç³»çµ±æœƒè‡ªå‹•è¨­ç½®ç‚ºå°åŒ—æ™‚é–“

## ğŸ“± å‰ç«¯é€£æ¥

### WebSocketé€£æ¥ï¼ˆrealbetï¼‰
```javascript
const ws = new WebSocket('ws://localhost:3010/ws');

ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.type === 'new_bet') {
    console.log('æ–°ä¸‹æ³¨:', data);
  }
};
```

### HTTP APIï¼ˆhisbetï¼‰
```bash
# ç²å–ç³»çµ±å¥åº·ç‹€æ…‹
curl http://localhost:3008/api/health

# ç²å–é æ¸¬æ•¸æ“š
curl http://localhost:3008/api/prediction
```